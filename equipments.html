<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Lista de equipamentos disponíveis e indisponíveis no sistema de controle.">
  <meta name="keywords" content="equipamentos, lista, controle, status">
  <title>Equipamentos - Controle de Equipamentos</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen">
  <nav id="navbar" class="bg-blue-600 p-4 text-white shadow-md">
    <div class="max-w-7xl mx-auto flex justify-between items-center">
      <h1 class="text-xl font-bold">Controle de Equipamentos</h1>
      <div class="space-x-4">
        <a href="dashboard.html" class="hover:underline">Dashboard</a>
        <a href="equipments.html" class="hover:underline">Equipamentos</a>
        <a href="index.html" class="hover:underline" onclick="logout()">Sair</a>
      </div>
    </div>
  </nav>
  <div id="equipment-list-page" class="p-4 max-w-7xl mx-auto">
    <h1 class="text-3xl font-bold mb-6">Lista de Equipamentos</h1>
    <div id="equipment-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 equipment-list"></div>
  </div>

  <script>
    // Dados iniciais dos equipamentos (equipments.json)
    const initialEquipments = [
      { id: 1, type: 'Empilhadeira', name: 'Empilhadeira 01', status: 'Disponível', history: [] },
      { id: 2, type: 'Empilhadeira', name: 'Empilhadeira 02', status: 'Manutenção', history: [] },
      { id: 3, type: 'Empilhadeira', name: 'Empilhadeira 03', status: 'Indisponível', history: [{ type: 'unavailability', os: 'OS001', responsible: 'Maria', reason: 'Falha mecânica', date: '08/05/2025 10:00:00' }] },
      { id: 4, type: 'Empilhadeira', name: 'Empilhadeira 04', status: 'Inspeção', history: [] },
      { id: 5, type: 'Guindaste Rodoviário', name: 'Guindaste Rodoviário 01', status: 'Disponível', history: [] },
      { id: 6, type: 'Guindaste Rodoviário', name: 'Guindaste Rodoviário 02', status: 'Manutenção', history: [] },
      { id: 7, type: 'Guindaste Rodoviário', name: 'Guindaste Rodoviário 03', status: 'Indisponível', history: [{ type: 'unavailability', os: 'OS002', responsible: 'Ana', reason: 'Problema elétrico', date: '06/05/2025 12:00:00' }] },
      { id: 8, type: 'Guindaste Rodoviário', name: 'Guindaste Rodoviário 04', status: 'Inspeção', history: [] },
      { id: 9, type: 'Guindaste Portuário', name: 'Guindaste Portuário 01', status: 'Disponível', history: [] },
      { id: 10, type: 'Guindaste Portuário', name: 'Guindaste Portuário 02', status: 'Manutenção', history: [] },
      { id: 11, type: 'Guindaste Portuário', name: 'Guindaste Portuário 03', status: 'Indisponível', history: [{ type: 'unavailability', os: 'OS003', responsible: 'Lucas', reason: 'Avaria', date: '05/05/2025 08:00:00' }] },
      { id: 12, type: 'Caminhão Truck', name: 'Caminhão Truck 01', status: 'Disponível', history: [] },
      { id: 13, type: 'Caminhão Truck', name: 'Caminhão Truck 02', status: 'Manutenção', history: [] },
      { id: 14, type: 'Carreta', name: 'Carreta 01', status: 'Indisponível', history: [{ type: 'unavailability', os: 'OS004', responsible: 'Clara', reason: 'Pneu furado', date: '07/05/2025 15:00:00' }] },
      { id: 15, type: 'Carreta', name: 'Carreta 02', status: 'Inspeção', history: [] },
      { id: 16, type: 'Carreta', name: 'Carreta 03', status: 'Disponível', history: [] },
      { id: 17, type: 'Prancha Baixa', name: 'Prancha Baixa 01', status: 'Manutenção', history: [] },
      { id: 18, type: 'Prancha Baixa', name: 'Prancha Baixa 02', status: 'Indisponível', history: [{ type: 'unavailability', os: 'OS005', responsible: 'Rafael', reason: 'Problema hidráulico', date: '08/05/2025 11:00:00' }] },
      { id: 19, type: 'Linha de Eixo', name: 'Linha de Eixo 01', status: 'Disponível', history: [] },
      { id: 20, type: 'Traquitana', name: 'Traquitana 01', status: 'Inspeção', history: [] },
      { id: 21, type: 'Traquitana', name: 'Traquitana 02', status: 'Disponível', history: [] },
      { id: 22, type: 'Bote', name: 'Bote 01', status: 'Manutenção', history: [] },
      { id: 23, type: 'Bote', name: 'Bote 02', status: 'Indisponível', history: [{ type: 'unavailability', os: 'OS006', responsible: 'Sofia', reason: 'Motor danificado', date: '06/05/2025 13:00:00' }] },
    ];

    // Função para carregar equipamentos do localStorage
    function loadEquipments() {
      const saved = localStorage.getItem('equipments');
      return saved ? JSON.parse(saved) : initialEquipments;
    }

    // Função para obter ícone SVG
    function getEquipmentIcon(type) {
      switch (type) {
        case 'Empilhadeira':
          return `<svg class="w-12 h-12" viewBox="0 0 24 24" fill="currentColor"><path d="M20 6h-4V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v2H4a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2zM10 4h4v2h-4V4zm10 14H4V8h16v10z"/><circle cx="6" cy="16" r="2"/><circle cx="18" cy="16" r="2"/></svg>`;
        case 'Guindaste Rodoviário':
          return `<svg class="w-12 h-12" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2a2 2 0 0 0-2 2v4H6l-4 8h20l-4-8h-4V4a2 2 0 0 0-2-2zm0 2h2v4h-2V4zm-4 6h8l2 4H6l2-4zm4 6a2 2 0 0 0-2 2h2v4h2v-4h2a2 2 0 0 0-2-2z"/></svg>`;
        case 'Guindaste Portuário':
          return `<svg class="w-12 h-12" viewBox="0 0 24 24" fill="currentColor"><path d="M4 20h16v-2H4v2zm8-18a2 2 0 0 0-2 2v6H6l-4 8h20l-4-8h-4V4a2 2 0 0 0-2-2zm0 2h2v6h-2V4zm-4 8h8l2 4H6l2-4z"/></svg>`;
        case 'Caminhão Truck':
          return `<svg class="w-12 h-12" viewBox="0 0 24 24" fill="currentColor"><path d="M20 6H4a2 2 0 0 0-2 2v8h2.5a2.5 2.5 0 0 0 5 0H14a2.5 2.5 0 0 0 5 0H22V8a2 2 0 0 0-2-2zM7 16a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm10 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/></svg>`;
        case 'Carreta':
          return `<svg class="w-12 h-12" viewBox="0 0 24 24" fill="currentColor"><path d="M20 6H4a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h2.5a2.5 2.5 0 0 0 5 0H16a2.5 2.5 0 0 0 5 0H20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2zM9 16a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm10 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/></svg>`;
        case 'Prancha Baixa':
          return `<svg class="w-12 h-12" viewBox="0 0 24 24" fill="currentColor"><path d="M22 10H2v6a2 2 0 0 0 2 2h2.5a2.5 2.5 0 0 0 5 0H16a2.5 2.5 0 0 0 5 0H20a2 2 0 0 0 2-2v-6zM9 16a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm10 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/></svg>`;
        case 'Linha de Eixo':
          return `<svg class="w-12 h-12" viewBox="0 0 24 24" fill="currentColor"><path d="M22 8H2v8a2 2 0 0 0 2 2h2.5a2.5 2.5 0 0 0 5 0h3a2.5 2.5 0 0 0 5 0H20a2 2 0 0 0 2-2V8zM9 16a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm10 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/></svg>`;
        case 'Traquitana':
          return `<svg class="w-12 h-12" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2a2 2 0 0 0-2 2v4H6v12h12V8h-4V4a2 2 0 0 0-2-2zm0 2h2v4h-2V4zm-4 6h8v8H8v-8z"/></svg>`;
        case 'Bote':
          return `<svg class="w-12 h-12" viewBox="0 0 24 24" fill="currentColor"><path d="M20 6L12 2 4 6v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V6zm-8 2l6 4v6H6v-6l6-4z"/></svg>`;
        default:
          return '';
      }
    }

    // Função para obter cor do LED
    function getLedColor(status) {
      switch (status) {
        case 'Disponível': return 'bg-green-500';
        case 'Manutenção': return 'bg-yellow-500';
        case 'Indisponível': return 'bg-red-500';
        case 'Inspeção': return 'bg-gray-500';
        default: return 'bg-gray-300';
      }
    }

    // Função para logout
    function logout() {
      localStorage.removeItem('userType');
    }

    // Verificar login
    if (!localStorage.getItem('userType')) {
      window.location.href = 'index.html';
    }

    // Carregar equipamentos
    const equipments = loadEquipments();

    // Renderizar lista
    const equipmentList = document.getElementById('equipment-list');
    equipments.forEach(eq => {
      const card = document.createElement('div');
      card.className = 'bg-white p-4 rounded-lg shadow-md flex flex-col items-center';
      card.innerHTML = `
        <div class="flex items-center mb-2">
          ${getEquipmentIcon(eq.type)}
          <h2 class="text-xl font-semibold ml-2">${eq.name}</h2>
        </div>
        <div class="flex space-x-2 mb-2">
          <div class="w-4 h-4 rounded-full ${getLedColor(eq.status)}"></div>
          <div class="w-4 h-4 rounded-full ${eq.status === 'Manutenção' ? 'bg-yellow-500' : 'bg-gray-300'}"></div>
          <div class="w-4 h-4 rounded-full ${eq.status === 'Indisponível' ? 'bg-red-500' : 'bg-gray-300'}"></div>
          <div class="w-4 h-4 rounded-full ${eq.status === 'Inspeção' ? 'bg-gray-500' : 'bg-gray-300'}"></div>
        </div>
        <p class="text-gray-600">Status: ${eq.status}</p>
        <button onclick="window.location.href='equipment-details.html?id=${eq.id}'" class="mt-4 bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500">
          Acessar
        </button>
      `;
      equipmentList.appendChild(card);
    });
  </script>
</body>
</html>